<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lapak Penjualan Digital</title>
    <meta name="description" content="Toko online penjualan produk digital dengan berbagai kategori produk">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        
        const firebaseConfig = {
            apiKey: "AIzaSyCUqgAA2e__tiaQjQuRRZcQTsLIM5JC1nI",
            authDomain: "marketplacesj-d0767.firebaseapp.com",
            projectId: "marketplacesj-d0767",
            messagingSenderId: "443129735278",
            appId: "1:443129735278:web:db6191a42628bf47fc5e7f",
            measurementId: "G-BDWGEB9T5T"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        window.firebaseApp = app;
        window.db = db;
        window.firebaseModules = {
            collection, getDocs, addDoc, updateDoc, deleteDoc, doc, serverTimestamp, query, orderBy
        };
    </script>
</head>
<body>
    <div class="sidebar-overlay" id="overlay"></div>
    
    <div id="wishlist-sidebar">
        <div class="wishlist-header">
            <h2>‚ù§Ô∏è Daftar Favorit</h2>
            <button onclick="closeSidebars()" class="close-btn">√ó</button>
        </div>
        <div id="wishlist-items"></div>
        <div class="sidebar-empty">
            <p>Klik tombol hati pada produk untuk menambahkannya ke favorit</p>
        </div>
    </div>
    
    <div id="cart-sidebar">
        <div class="cart-header">
            <h2>üõí Keranjang Belanja</h2>
            <button onclick="closeSidebars()" class="close-btn">√ó</button>
        </div>
        <div id="cart-items"></div>
        <div class="cart-actions">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cart-total">Rp 0</span>
            </div>
            <button onclick="checkoutCart()" class="btn-checkout">
                üí¨ Checkout via WhatsApp
            </button>
            <button onclick="clearCart()" class="btn-clear">
                üóëÔ∏è Kosongkan Keranjang
            </button>
        </div>
    </div>
    
    <header>
        <div class="container nav-container">
            <a href="#" class="logo">Lapak<span>Digital</span></a>
            <div class="nav-buttons">
                <button id="wishlist-btn" class="nav-btn">‚ù§Ô∏è Favorit (<span id="wishlist-count">0</span>)</button>
                <button id="cart-btn" class="nav-btn">üõí Keranjang (<span id="cart-count">0</span>)</button>
                <button id="admin-btn" class="nav-btn admin">üîß Admin</button>
            </div>
        </div>
    </header>
    
    <section class="hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Lapak Penjualan Digital</h1>
                <p class="hero-subtitle">Toko online terpercaya untuk berbagai produk digital dengan harga terbaik dan proses aman.</p>
            </div>
        </div>
    </section>
    
    <main id="toko-container">
        <div class="container">
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Cari produk...">
                <button onclick="cariProduk()" class="btn-search">üîç Cari</button>
                <button onclick="resetPencarian()" class="btn-reset">üîÑ Reset</button>
            </div>
            
            <div class="category-filter"></div>
            
            <h2 class="section-title">Produk Terbaru <span id="product-count">(0 produk)</span></h2>
            
            <div id="loading">
                <div class="spinner"></div>
                <p>Memuat produk...</p>
            </div>
            
            <div id="daftar-produk" class="produk-grid"></div>
            <div id="no-products">
                <p>Belum ada produk tersedia.</p>
            </div>
        </div>
    </main>
    
    <section id="admin-area" class="admin-hidden">
        <div class="container">
            <div id="login-form">
                <h2>Masuk Admin</h2>
                <input type="text" id="admin-username" placeholder="Username">
                <input type="password" id="admin-password" placeholder="Password">
                <button onclick="loginAdmin()" class="btn-login">Login</button>
                <button onclick="batalAdmin()" class="btn-secondary">Batal</button>
                <p id="login-msg"></p>
            </div>
            
            <div id="admin-dashboard" class="dashboard-hidden">
                <h2>üõ†Ô∏è Kelola Produk</h2>
                
                <div class="admin-section">
                    <h3>Tambah Produk Baru</h3>
                    <input type="text" id="input-nama" placeholder="Nama Produk" maxlength="50">
                    <input type="number" id="input-harga" placeholder="Harga" min="1000" max="10000000">
                    <input type="text" id="input-nomor" placeholder="Nomor WA Penjual (628...)" pattern="62\d{9,12}">
                    <input type="text" id="input-deskripsi" placeholder="Deskripsi Produk (opsional)">
                    <select id="input-kategori"></select>
                    <div class="upload-area">
                        <label for="input-gambar">Gambar Produk (opsional):</label>
                        <input type="file" id="input-gambar" accept="image/*" onchange="previewImage('input-gambar', 'preview-tambah')">
                        <div id="preview-tambah" class="image-preview">
                            <p>Pratinjau gambar akan muncul di sini</p>
                        </div>
                        <small>Ukuran maksimal: 500KB. Format: JPG, PNG</small>
                    </div>
                    <button onclick="tambahProduk()" class="btn-add">Tambah Produk</button>
                </div>
                
                <div class="admin-section" id="edit-section">
                    <h3>Edit Produk</h3>
                    <input type="hidden" id="edit-index">
                    <input type="hidden" id="edit-id">
                    <input type="text" id="edit-nama" placeholder="Nama Produk" maxlength="50">
                    <input type="number" id="edit-harga" placeholder="Harga" min="1000" max="10000000">
                    <input type="text" id="edit-nomor" placeholder="Nomor WA Penjual (628...)" pattern="62\d{9,12}">
                    <input type="text" id="edit-deskripsi" placeholder="Deskripsi Produk">
                    <select id="edit-kategori"></select>
                    <div class="upload-area">
                        <label for="edit-gambar">Gambar Produk:</label>
                        <div class="edit-image-actions">
                            <button type="button" onclick="document.getElementById('edit-gambar').click()" class="btn-secondary">
                                Ubah Gambar
                            </button>
                            <button type="button" onclick="hapusGambarEdit()" class="btn-hapus">
                                Hapus Gambar
                            </button>
                        </div>
                        <input type="file" id="edit-gambar" accept="image/*" onchange="previewImage('edit-gambar', 'preview-edit')">
                        <div id="preview-edit" class="image-preview">
                            <p>Gambar saat ini akan muncul di sini</p>
                        </div>
                        <small>Kosongkan jika tidak ingin mengubah gambar</small>
                    </div>
                    <button onclick="simpanEdit()" class="btn-save">Simpan Perubahan</button>
                    <button onclick="batalEdit()" class="btn-secondary">Batal Edit</button>
                </div>
                
                <div class="admin-section">
                    <h3>Produk Saat Ini <small>(Klik untuk edit)</small></h3>
                    <div id="admin-produk-list" class="produk-grid"></div>
                </div>
                
                <div class="admin-footer">
                    <button onclick="logoutAdmin()" class="btn-logout">Logout</button>
                    <button onclick="batalAdmin()" class="btn-secondary">Kembali ke Toko</button>
                </div>
            </div>
        </div>
    </section>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">Lapak<span>Digital</span></div>
                <div class="footer-bottom">
                    <p>&copy; 2024 Lapak Digital | <span id="total-products">0</span> produk tersedia</p>
                    <p id="firebase-status">‚úÖ Terhubung ke Firebase</p>
                </div>
            </div>
        </div>
    </footer>
    
    <script src="script.js"></script>
</body>
</html>